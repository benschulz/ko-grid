/*
 Copyright (c) 2015, Ben Schulz
 License: BSD 3-clause (http://opensource.org/licenses/BSD-3-Clause)
*/
(function(w){"function"===typeof define&&define.amd?define(["require","knockout","ko-data-source","ko-indexed-repeat"],w):window["ko-grid"]=w(function(q,t){if(!Array.isArray(q)||1!==q.length||"string"!==typeof q[0]||"function"!==typeof t)throw Error("Assertion error.");var w=window.ko.bindingHandlers.grid.config=window.ko.bindingHandlers.grid.config||{};t(w[q[0]])},window.ko)})(function(w,q){var t,B,C,x,y,A;t=function(){var a;a=function(){function a(n,h){return Object.prototype.hasOwnProperty.call(n,
h)}return{Qa:function(a,h){if(a===h)return!0;var e=!!h&&"function"===typeof h.valueOf;return!!a&&"function"===typeof a.valueOf&&e&&a.valueOf()===h.valueOf()},extend:function(a,h){Array.prototype.slice.call(arguments,1).forEach(function(e){for(var d=Object.keys(e),b=0,c=d.length;b<c;b++){var p=d[b],f=Object.getOwnPropertyDescriptor(e,p);void 0!==f&&f.enumerable&&Object.defineProperty(a,p,f)}});return a},Z:function(n,h){for(var e in n)a(n,e)&&h(e,n[e])},v:a,mb:function(n,h){var e={},d;for(d in n)a(n,
d)&&(e[d]=h(n[d],d,n));return e}}}();return function(a){return a}(function(a,n,h){return{e:a,c:n,J:h}}(function(a){function n(b){return b.filter(function(b,a,f){return f.lastIndexOf(b)===a})}function h(b,c){for(var a=b.length,f=-1,m=0;m<a;++m)if(c(b[m])){if(0<=f)throw Error("Multiple elements match the predicate.");f=m}return f}function e(b,c){return b&&"function"===typeof b.valueOf&&c&&"function"===typeof c.valueOf?b.valueOf()<=c.valueOf()?b.valueOf()<c.valueOf()?-1:0:1:b<=c?b<c?-1:0:1}function d(b,
c){var a=b.length,f=Array(a),m=Array(a),k;for(k=0;k<a;++k)f[k]=k,m[k]=b[k];k=b;b=m;m=k;f.sort(function(g,r){return c(b[g],b[r])||g-r});for(k=0;k<a;++k)m[k]=b[f[k]];return m}return{contains:function(b,c){return 0<=b.indexOf(c)},ab:function(b){if(50<b.length){for(var c=b.length,d={},f,m=0;m<c;++m)if(f=b[m],"string"===typeof f)if(a.v(d,f))break;else d[f]=!0;else if(b.lastIndexOf(f)!==m)break;if(!(m>=c)){for(var k=b.slice(0,m);m<c;++m)f=b[m],"string"===typeof f?a.v(d,f)||(d[f]=!0,k.push(f)):b.lastIndexOf(f)===
m&&k.push(f);b=k}}else b=n(b);return b},Y:function(b,c){return Array.prototype.concat.apply([],b.map(c))},vb:function(b,c){var a=h(b,c);if(0>a)throw Error("None of the elements matches the predicate.");return b[a]},wb:function(b,c){var a=h(b,c);return 0<=a?b[a]:null},Ia:function(b,c){var a=c||e;window.chrome?a=d(b,a):(b.sort(a),a=b);return a}}}(a),a,{oa:function(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},Wa:function(a){return a.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()})},
format:function(a){var n=arguments;return a.replace(/{(\d+)}/g,function(a,e){var d=parseInt(e,10)+1;return typeof n.length<=d?a:n[d]})}}))}();B=function(){var a=/^[a-z]+(-[a-z]+)*$/,l=/\x3c!--(?:(before|after):)?([a-z]+(-[a-z]+)*)--\x3e*/g;return function(n){function h(a,c){c=c||function(a,g){return g+a};return function(k){var g=e(k,a);return{M:function(r,a){var k=a?r:null,f=(a=a?a:r)?k:null,h=a,k=c;f&&b(f,2);d(h);f=f?e(f,3)+h+e(f,4):h;k=k(g,f);p=p.replace(g,k)}}}}function e(a,b){function k(r){if(c[a]!==
r)throw Error("Operation is not defined for placeholder `"+a+"`.");}if(!c[a])throw Error("Unknown placeholder id `"+a+"`.");var g="\x3c!--"+a+"--\x3e",r="\x3c!--before:"+a+"--\x3e",u="\x3c!--after:"+a+"--\x3e";switch(b){case 1:return k(1),delete c[a],g;case 2:return k(1),g;case 3:return k(2),r;case 4:return k(2),u;case 5:case 6:return 1===c[a]?g:5===b?u:r}throw Error("Assertion error. Unkown operator: `"+b+"`");}function d(a){for(var c;c=l.exec(a);){var k=c[1],g="before"===k;c=c[2];if(k&&1!==(a.match(new RegExp((g?
"after":"before")+":"+c,"g"))||[]).length)throw Error("Multiple or unmatched before-/after-placeholders for placeholder id `"+c+"`.");k&&!g||b(c,k?2:1)}}function b(b,d){if(!a.test(b))throw Error("Invalid placeholder id `"+b+"`");if(c[b])throw Error("Placeholder id `"+b+"` is already taken.");c[b]=d}var c={},p=n;d(p);this.replace=function(a){return{ca:h(1,function(a,b){return b})(a).M}};this.Ja=function(a){return{append:h(5)(a).M,Da:h(6,function(a,b){return a+b})(a).M}};this.Sa=function(){return p.replace(l,
"")}}}();C=function(a,l){function n(a){return null===a?"":""+a}function h(e,d,b){this.id=this.id=b.id;this.property=this.aa=b.property||this.id;this.userDefined=this.ba=!1!==b.ba;this.l=!b.hidden;this.visible=this.visible;this.label=this.label=a.observable(b.label);this.width=this.width=a.observable(b.width);this.widthInPixels=this.P=function(){var a=this.width();if("px"!==a.substr(-2))throw Error("The only currently supported column width values are absolute pixel lengths.");return parseInt(a.substring(0,
a.length-2),10)}.bind(this);this.ta=a.observableArray(b.headerClasses||b.classes||[]);this.la=a.observableArray(b.cellClasses||b.classes||[]);this.f=a.observableArray(b.footerClasses||b.classes||[]);this.headerClasses=this.ta;this.cellClasses=this.la;this.footerClasses=this.f;this.metadata=this.ka=d.columnMetadataSupplier?d.columnMetadataSupplier(e.Ra,b):{};this.renderValue=this.H=d.cellValueRenderer?d.cellValueRenderer.bind(void 0,this):n;this.pa=function(a){this.H=a(this.H)}.bind(this);this.D=function(a){a=
a({o:this.s,update:this.ga});if(!a||!a.o||!a.update)throw Error("The cell value binding must define an `init` as well as an `update` method.");this.s=a.o;this.ga=a.update}.bind(this);this.overrideValueRendering=this.pa;this.overrideValueBinding=this.D}a.bindingHandlers.__gridColumn={init:function(){},update:function(a,d){var b=d();a.style.width=b.width()}};return{o:function(a){a.replace("columns").ca(l)},k:function(e,d,b){function c(a){a=new h(b,d,a);d.columnInitializer&&d.columnInitializer(a);return a}
var p=[];this.all=this.all=a.observableArray(e.columns.map(c));this.byId=this.ja=function(a){var b=this.Ka(a);if(!b)throw Error("The column id `"+a+"` is undefined.");return b}.bind(this);this.tryById=this.Ka=function(a){var b=this.all().filter(function(b){return b.id===a});if(1<b.length)throw Error("Assertion error: Multiple columns with id `"+a+"`.");return b[0]}.bind(this);var f=a.observable(this.all().filter(function(a){return a.l}));this.displayed=this.h=function(){return f()};this.show=function(a){this.I(function(b){return b.l||
b===a})}.bind(this);this.fb=function(a){this.I(function(b){return b.l&&b!==a})}.bind(this);this.show=this.show;this.hide=this.fb;this.reorder=this.ub=function(a){var b=this.all().slice(),g=[];a.forEach(function(a){b.splice(b.indexOf(a),1);g.push(a)});if(b.length)throw Error("The new column order must contain all columns.");this.all(g);this.I(function(a){return a.l})}.bind(this);this.showOnlyThoseWhich=this.I=function(a){var b=this.all();a=b.filter(a);b.forEach(function(a){a.l=!1});a.forEach(function(a){a.l=
!0});f(a)}.bind(this);this.combinedWidth=this.Ua=a.pureComputed(function(){for(var a=0,b=this.h(),g=0;g<b.length;++g)a+=b[g].P();return a}.bind(this));this.add=this.add=function(a){a=c({ba:!1,id:"$"+a.id,label:a.label,hidden:a.hidden||!1,width:a.width});this.all.unshift(a);this.I(function(a){return a.l});return a}.bind(this);this.m=function(){p.forEach(function(a){a.dispose()})}}}}(q,'<colgroup class="ko-grid-colgroup">\n    <col class="ko-grid-col" data-bind="indexedRepeat: { forEach: columns.displayed, indexedBy: \'id\', as: \'column\' }" data-repeat-bind="__gridColumn: column()">\n</colgroup>');
x=function(a){var l,n,h;l=function(a){return function(d,b){return a.c.extend(d,{get stringifyable(){return b()}})}}(a);n=function(a,d){function b(){return 0}function c(a,b){return"string"===typeof a&&"string"===typeof b?a.localeCompare(b):a<=b?a<b?-1:0:1}function p(b,g){a.c.extend(b,{get onResultOf(){return this.G},get reverse(){return this.reverse},get callable(){return this.F}},{get G(){return function(a){return f(a,b)}},get reverse(){return function(){return g||h(b)}},get F(){return b}})}function f(a,
b){function r(r,c){return b(a(r),a(c))}p(r);d(r,function(){return{type:"by-function-comparator","function":a.stringifyable,comparator:b.stringifyable}});return r}function h(a){function b(r,g){return-a(r,g)}p(b,a);d(b,function(){return{type:"reversed-comparator",comparator:a.stringifyable}});return b}p(c);d(c,function(){return{type:"natural-comparator"}});p(b);d(b,function(){return{type:"indifferent-comparator"}});return{hb:b,f:c}}(a,l);h=function(a,d){function b(b){a.c.extend(b,{get callable(){return this.F}},
{get F(){return b}})}return{sb:function(a){function e(b){return b[a]}b(e);d(e,function(){return{type:"property-accessor",propertyName:a}});return e}}}(a,l);a=function(a,d){function b(){return!0}function c(){return!1}function p(b,u){a.c.extend(b,{get and(){return this.C},get negate(){return this.xa},get onResultOf(){return this.G},get or(){return this.O},get callable(){return this.F}},{get C(){return function(a){return f([b,a])}},get xa(){return function(){return u||k(b)}},get G(){return function(a){return h(a,
b)}},get O(){return function(a){return g([b,a])}},get F(){return b}})}function f(a){function g(b){for(var u=0,c=a.length;u<c;++u)if(!a[u](b))return!1;return!0}if(!a.length)return b;p(g);d(g,function(){return{type:"and-predicate",components:a.map(function(a){return a.stringifyable})}});return g}function h(a,b){function g(c){return b(a(c))}p(g);d(g,function(){return{type:"by-function-predicate","function":a.stringifyable,predicate:b.stringifyable}});return g}function k(a){function b(g){return!a(g)}
p(b,a);d(b,function(){return{type:"negated-predicate",predicate:a.stringifyable}});return b}function g(a){function b(g){for(var c=0,u=a.length;c<u;++c)if(a[c](g))return!0;return!1}if(!a.length)return c;p(b);d(b,function(){return{type:"or-predicate",components:a.map(function(a){return a.stringifyable})}});return b}p(c);d(c,function(){return{type:"always-false-predicate"}});p(b);d(b,function(){return{type:"always-true-predicate"}});return{f:c,D:b,C:f,ka:function(a,b){function g(b){return a(b)}p(g);
d(g,b);return g},O:g,tb:function(a){function b(g){return a.test(g)}p(b);d(b,function(){return{type:"regular-expression-predicate",regularExpression:a.source,caseSensitive:!a.ignoreCase,multiline:a.multiline}});return b}}}(a,l);return function(a){return a}({t:n,L:h,d:a,lb:l,yb:function(a,d){return"function"===typeof d||"object"===typeof d?d.stringifyable||d:d}})}(t);y=function(a,l){function n(e){var d=e.defaultPrevented;a.c.extend(this,e,{preventDefault:function(){d=!0;return e.preventDefault()},pa:function(){d=
!0},get defaultPrevented(){return d}})}function h(a,d){this.$=a;this.Ha=d}return function(e){function d(c,d,f){function e(a){a=Array.prototype.slice.call(c.querySelectorAll(a)).filter(function(a){return l.va(a,d.target)});return a.length?a[a.length-1]:void 0}var k=l.qa.bind(null,c),g=b.map(function(a){var b=a.Ha?e(a.Ha):c;return{$:a.$,match:b,depth:b?k(b):-1}}).filter(function(a){return!!a.match});a.e.Ia(g,function(a,b){return b.depth-a.depth});g.forEach(function(a){a.$.apply(c,f)})}e=e||function(a){return[a]};
var b=[];this.w=function(a,d){var f=1<arguments.length?a:void 0;d=1<arguments.length?d:a;b.push(new h(d,f))};this.Ga=function(a){return{ra:function(b){var f=l.element.ma(b.target,a);f&&(b=new n(b),d(f,b,e(b,f)))}}}}}(t,function(){return function(a){return a}(function(){function a(a,e){return!!(a.compareDocumentPosition(e)&16)}var l=window.Element,n=l.prototype.webkitMatchesSelector||l.prototype.mozMatchesSelector||l.prototype.msMatchesSelector||l.prototype.matches;return{qa:function(a,e){for(var d=
0;e;){if(e===a)return d;e=e.parentNode;++d}throw Error("The given node is not part of the subtree.");},va:function(h,e){return h===e||a(h,e)},xb:a,element:{ma:function(a,e){do{if(n.call(a,e))return a;a=a.parentElement}while(a);return null},matches:function(a,e){return n.call(a,e)}}}}())}());x=function(a,l,n,h,e){function d(a){this.j(function(b){b();this.r=a.element.querySelector(".ko-grid-tbody")}.bind(this));return function(){this.r=null}.bind(this)}function b(){var b=[],c={};this.rows=this.rows=
c;c.h=a.observableArray([]);c.displayed=c.h;c.X=a.observable(!1).extend({Hb:"always"});c.displayedSynchronized=c.X;c.__handleDisplayedRowsDeviate=function(){this.rows.X(!1)}.bind(this);c.__handleDisplayedRowsSynchronized=function(){this.rows.X(!0)}.bind(this);var d=this.view;c.__dirty=d.dirty;b.push(d.observables.subscribe(function(a){c.h(a)}));c.h(d.observables());var f=[];c.__classify=function(a){var b=f.map(function(b){return b(a)});return Array.prototype.concat.apply([],b)};c.ib=function(a){f.push(a)};
c.installClassifier=c.ib;return function(){b.forEach(function(a){a.dispose()})}}function c(){function b(c,g){var d=a.contextFor(g),f=d.row(),d=d.column();return[c,f[d.aa],f,d]}function c(a){return function(b){a.Ga(".ko-grid-cell").ra(b);return!b.defaultPrevented}}var d=new h(b),f=new h(b),e=new h(b),k=new h(b);this.rb=d.w.bind(d);this.ob=f.w.bind(f);this.qb=e.w.bind(e);this.pb=k.w.bind(k);this["onCellMouseDown "]=this.rb;this["onCellClick "]=this.ob;this["onCellDoubleClick "]=this.qb;this["onCellContextMenu "]=
this.pb;this.j(function(a){a();this.r.addEventListener("mousedown",c(d));this.r.addEventListener("click",c(f));this.r.addEventListener("dblclick",c(e));this.r.addEventListener("contextmenu",c(k))}.bind(this));return function(){}}function p(b){function c(a,b){for(var g=a.firstChild,d=-1;g;){if(g.nodeType===m&&"TD"===g.tagName&&0<=(" "+g.className+" ").indexOf("td")&&++d===b)return g;g=g.nextSibling}throw Error("Column `"+b+"` does not exist.");}var d=function(a){for(var b=this.r.firstChild,g=-1;b;){if(b.nodeType===
m&&"TR"===b.tagName&&0<=(" "+b.className+" ").indexOf("ko-grid-row")&&++g===a)return b;b=b.nextSibling}throw Error("Row `"+a+"` does not exist.");}.bind(this);this.lookupCell=this.kb=function(e,h){var p=this.rows.h().indexOf(e),n=b.g.h().indexOf(h),l=c(d(p),n);return{element:l,hijack:function(b){function g(){for(l.removeAttribute("data-hijacked");l.firstChild;)a.removeNode(l.firstChild);var b=a.contextFor(l).row();h.s?h.s(l,b,h):l.appendChild(k.createTextNode(""));f(l,b(),h)}if(l.hasAttribute("data-hijacked"))throw Error("Illegal state: This cell is already hijacked.");
for(;l.firstChild;)a.removeNode(l.firstChild);l.className+=" "+b;l.setAttribute("data-hijacked","hijacked "+b);return{dispose:g,release:g}}}}.bind(this);return function(){}}function f(b,c,d){var f=c[d.aa],e=f&&a.unwrap(f),k=b.getAttribute("data-hijacked"),h=d.la.peek().join(" ");b.className="ko-grid-td ko-grid-cell "+h+(k?" "+k:"");k||(d.s?d.ga(b,f,c,d):b.lastChild.nodeValue=d.H(e))}var m=window.Node.ELEMENT_NODE,k=window.document;a.bindingHandlers.__gridRow={init:function(){},update:function(a,b){var c=
b(),d=c.classify,f=c.row(),c=1===c.index()%2?["ko-grid-tr","ko-grid-row","alternate"]:["ko-grid-tr","ko-grid-row"],d=d(f);a.className=c.concat(d).join(" ")}};a.bindingHandlers.__gridCell={init:function(b,c){for(var d=c(),f=d.row,d=d.column,e=d();b.firstChild;)a.removeNode(b.firstChild);e.s?e.s(b,f,d):b.appendChild(k.createTextNode(""));return{controlsDescendantBindings:!0}},update:function(a,b){var c=b(),d=c.row(),c=c.column.peek();f(a,d,c)}};return{o:function(a){a.replace("body").ca("body",e);a.Ja("table").Da("<div class=\"ko-grid-load-indicator\" data-bind=\"style: { display: data.rows.__dirty() ? 'block' : 'none' }\">Loading&hellip;</div>")},
k:function(g,f,e){var k=[];this.source=g.dataSource;this.valueSelector=this.La=g.valueSelector||f.valueSelector||function(a){return a};this.observableValueSelector=this.nb=g.observableValueSelector||f.observableValueSelector||this.La;this.predicates=this.d=a.observableArray(g.filters||[]);this.predicate=this.Ca=a.pureComputed(function(){return n.d.C(this.d().map(a.unwrap))}.bind(this));this.comparator=this.na=a.observable(n.t.hb);this.offset=this.offset=a.observable(0);this.limit=this.wa=a.observable(Number.POSITIVE_INFINITY);
g=this.source.openView(function(a){return a.filteredBy(this.Ca).sortedBy(this.na).offsetBy(this.offset).limitedTo(this.wa)}.bind(this));k.push(g.dispose.bind(g));this.view=this.view=g;this.B=function(){};this.j=function(a){var b=this.B;this.B=function(){a(b)}}.bind(this);k.push(d.call(this,e));k.push(b.call(this));k.push(c.call(this));k.push(p.call(this,e));this.m=function(){k.forEach(function(a){a()})}}}}(q,t,x,y,'<tbody class="ko-grid-tbody" data-bind="_gridWidth: columns.combinedWidth() + \'px\'">\n    <tr class="ko-grid-tr ko-grid-row"\n        data-bind="indexedRepeat: {\n            forEach: data.rows.displayed,\n            indexedBy: function(r) { return grid.data.observableValueSelector(ko.unwrap(r[grid.primaryKey])); },\n            as: \'row\',\n            at: \'rowIndex\',\n            allowDeviation: true,\n            onDeviation: data.rows.__handleDisplayedRowsDeviate,\n            onSynchronization: data.rows.__handleDisplayedRowsSynchronized }"\n        data-repeat-bind="__gridRow: { classify: grid.data.rows.__classify, row: row, index: rowIndex }">\n\n        <td data-bind="indexedRepeat: { forEach: columns.displayed, indexedBy: \'id\', as: \'column\', allowElementRecycling: false }"\n            data-repeat-bind="__gridCell: { row: row, column: column }"></td>\n    </tr>\n</tbody>');
y=function(a,l,n,h){function e(b){this.id=this.id="column-header-"+b.id;this.element=this.element=a.observable(null);this.rowSpan=this.rowSpan=a.observable(1);this.columnSpan=this.n=a.observable(1);this.label=this.label=b.label;this.column=this.V=b;this.columns=this.g=[b];this.T=function(a){this.rowSpan(a)}.bind(this)}function d(b){this.id=this.id="column-group-header-"+(b.id||"@__"+ ++k);this.element=this.element=a.observable(null);this.Pa=b;this.rowSpan=this.rowSpan=a.observable(b.height);this.columnSpan=
this.n=a.observable(1);this.label=this.label=a.observable(b.label);this.columns=this.g=[];this.T=function(a){this.g=[a];this.n(1)}.bind(this)}function b(a){function b(a){a.Ta.forEach(function(b){var c=d[b];if(!c)d[b]=a;else if(c!==a)throw Error("Column `"+b+"` is element of column group `"+c.label+"` as well as `"+a.label+"`.");});a.K&&b(a.K)}var d={};l.e.Y(a,c.bind(this,null)).forEach(function(a){b(a)});return d}function c(a,b){var d=p(b),f=b.elements.filter(function(a){return"string"!==typeof a}),
e=b.elements.filter(function(a){return"string"===typeof a}),d={id:b.id,label:b.label,K:a,depth:a?a.depth+1:0,height:a?a.Aa-d:1,Aa:d,Ta:e};return f.length?l.e.Y(f,c.bind(this,d)):d}function p(a){a=a.elements.filter(function(a){return"string"!==typeof a});return 1+Math.max.apply(Math,[0].concat(a.map(p)))}var f=window.document,m=window.Node,k=0;a.bindingHandlers.__gridHeader={init:function(b,c){var d=c()();d.element(b);a.utils.domNodeDisposal.addDisposeCallback(b,function(){d.element(null)});for(var e=
b.firstChild;e;){var k=e;k.nodeType===m.TEXT_NODE&&a.removeNode(k);e=e.nextSibling}b.insertBefore(f.createTextNode(""),b.firstChild);return{controlsDescendantBindings:!0}},update:function(a,b){var c=b()(),d=c.id.replace(/[\s]/g,"_");a.className=c.V?"ko-grid-th ko-grid-column-header "+d+" "+c.V.ta().join(" "):"ko-grid-th ko-grid-column-group-header "+d;d=c.g.map(function(a){return a.P()}).reduce(function(a,b){return a+b})+"px";a.style.width=d;a.style.maxWidth=d;a.rowSpan=c.rowSpan();a.colSpan=c.n();
for(d=a.firstChild;d.nodeType!==m.TEXT_NODE;)d=d.nextSibling;d.nodeValue=c.label()}};return{o:function(a){a.replace("head").ca(h)},k:function(c,f,k){function h(a,b,c){if(!a)return[];if(b[a.depth]&&b[a.depth].Pa===a){var f=a;do{var e=b[f.depth];e.g.push(c);e.n(e.n()+1);f=f.K}while(f);return[]}b.length=a.depth;var f=h(a.K,b,c),k=e=a.depth;a=l(m,new d(a));a.T(c);f[e]=b[k]=a;return f}function l(a,b){var c=b.id;return a[c]=a[c]||b}var p=b(c.columnGroups||[]),m={},q={},v=[];this.__rows=this.U=a.computed(function(){var b=
k.g.h(),c=0;b.forEach(function(a){a=p[a.id];c=Math.max(c,a?a.depth+a.Aa:0)});v.length=c+1;for(var d=0;d<v.length;++d)v[d]=v[d]||a.observableArray(),v[d].__rowId="header-row-"+d,v[d].valueWillMutate(),v[d]().length=0;var f=[];b.forEach(function(a){var b=p[a.id],d=b?b.depth+b.height:0;f.length=d;var k=l(q,new e(a));k.T(c-d+1);v[d]().push(k);a=h(b,f,a);for(b=0;b<a.length;++b)a[b]&&v[b]().push(a[b])});v.forEach(function(a){a.valueHasMutated()});return v});this.all=this.all=a.computed(function(){var a=
[];this.U().forEach(function(b){Array.prototype.push.apply(a,b())});return a}.bind(this));this.forColumn=this.eb=function(a){a="column-header-"+a.id;if(!Object.prototype.hasOwnProperty.call(q,a))throw Error("Es existiert kein Header f\u00fcr die gegebene Spalte.");return q[a]};var z=new n(function(b,d){return[b,a.contextFor(d).header()]});this.__handleClick=function(a,b){z.Ga(".ko-grid-column-header, .ko-grid-column-group-header").ra(b);return!b.defaultPrevented};this.za=z.w.bind(z);this.ya=function(a,
b){function d(a,c){c instanceof e&&b.apply(this,arguments)}var c=1<arguments.length;b=c?b:a;z.w.apply(z,c?[a,d]:[d])};this.onHeaderClick=this.za;this.onColumnHeaderClick=this.ya;this.m=function(){this.U.dispose();this.all.dispose()}.bind(this)}}}(q,t,y,'<thead class="ko-grid-thead" data-bind="_gridWidth: columns.combinedWidth() + \'px\'">\n    \x3c!--before:headers--\x3e\n    <tr class="ko-grid-tr ko-grid-headers"\n        data-bind="indexedRepeat: { forEach: headers.__rows, indexedBy: \'__rowId\', as: \'headerRow\' }"\n        data-repeat-bind="click: headers.__handleClick">\n\n        <th class="ko-grid-th"\n            data-bind="indexedRepeat: { forEach: headerRow(), indexedBy: \'id\', as: \'header\' }"\n            data-repeat-bind="__gridHeader: header"></th>\n    </tr>\n    \x3c!--after:headers--\x3e\n</thead>');
A=function(a,l,n,h,e){a=a.bindingHandlers.grid=a.bindingHandlers.grid||{};return a.core=a.core||{columns:l,data:n,headers:h,layout:e}}(q,C,x,y,function(a){function l(a,b,c,e){var f=a.element,l=f.querySelector(".ko-grid-table-scroller-padding"),k=f.querySelector(".ko-grid-table-scroller"),g=f.querySelector(".ko-grid-thead"),n=f.querySelector(".ko-grid-tfoot"),u=!1;return function(a){if(!u)try{b(u=!0);var d=k.scrollLeft;a&&a();c.forEach(function(a){a.call(f)});h(f,function(){l.style.borderTopWidth=
Math.max(g.clientHeight,0)+"px";l.style.borderBottomWidth=Math.max(n.clientHeight,0)+"px"});k.scrollLeft=d;e.forEach(function(a){a.call(f)})}finally{b(!1),u=!1}}}function n(a){a=a.element;var b=a.querySelector(".ko-grid-table-scroller"),c=a.querySelector(".ko-grid-thead"),e=a.querySelector(".ko-grid-tfoot");b.addEventListener("scroll",function(){var a=-b.scrollLeft+"px";c.style.left=a;e.style.left=a})}function h(a,b){if(a.offsetWidth&&a.offsetHeight)b();else{var c=a.parentNode,h=e.createComment("placeholder");
c.replaceChild(h,a);var f=a.style.position;a.style.position="absolute";a.style.visibility="hidden";e.body.appendChild(a);try{b()}finally{c.replaceChild(a,h),a.style.position=f,a.style.visibility="visible"}}}var e=window.document;return{o:function(){},k:function(d,b,c){function h(a){a&&a()}var f=a.observable(!1);this.recalculate=this.Fa=function(a){h(a)};var m=a.computed(function(){f()||(c.g.h().forEach(function(a){a.width()}),h())}),k=[],g=[];this.ia=function(a){k.push(a)};this.ha=function(a){g.push(a)};
this.beforeRelayout=this.ia;this.afterRelayout=this.ha;this.B=function(){n.call(this,c);h=l(c,f,k,g);c.Ba(h)}.bind(this);this.determineCellDimensions=this.$a=function(a){var b=e.createElement("div");b.className="ko-grid-td ko-grid-cell";b.appendChild("string"===typeof a?e.createTextNode(a):a);b.style.position="absolute";b.style.visibility="hidden";e.body.appendChild(b);try{return{width:b.offsetWidth,height:b.offsetHeight}}finally{e.body.removeChild(b)}};this.m=function(){m.dispose()}}}}(q));(function(a,
l){function n(a,c){if(l.c.v(d,a))throw Error("Extension id or alias already in use: `"+a+"`.");d[a]=c;c.S.push(a);return c}function h(a,c){this.Ea=a;this.W=c.W||[];this.ua=c.ua||function(){};this.k=c.k;this.S=[]}var e=a.bindingHandlers.grid=a.bindingHandlers.grid||{},d=e.extensions=e.extensions||{};e.Za=function(a,c){return n(a,new h(a,c))};e.N=function(a){if(!l.c.v(d,a))throw Error("No known extension id or alias: `"+a+"`.");return d[a]};e.Xa=function(a,c){return n(a,e.N(c))};e.Ya=function(a,c){var d=
e.N(c);a.forEach(function(a){return n(a,d)});return d};h.prototype={get jb(){return this.S.slice()},sa:function(a,c){var d=this.fa(a,function(a){throw Error("Conflicting configurations "+a.map(function(a){return"`"+a+"`"}).join(", ")+" (configuration: `"+c+"`).");});if(!d)throw Error("The extension `"+this.Ea+"` must be configured (configuration: `"+c+"`)");return a[d]},Ab:function(a){var c=this.fa(a,function(a){throw Error("Conflicting binding values "+a.map(function(a){return"`"+a+"`"}).join(", ")+
".");});return a[c]},fa:function(a,c){var d=this.S.filter(function(c){return l.c.v(a,c)});1<d.length&&c(d);return d[0]}};return d})(q,t);return function(a){return a}(function(a,l,n){function h(c,d){function e(){var a=m[c];d(a.Va,a.zb,a.bb)}m[c]?e():a([c],function(a){function d(e){e=b.N(e);var f=e.Ea,p=e.sa(h,c);if(!n.e.contains(l,f)){if(n.e.contains(q,f))throw Error("Dependency-Cycle: .. -> "+q.join(" -> ")+" -> "+f+" -> ..");q.push(f);e.W.forEach(d);e.ua(g,p,a);if(q.pop()!==f)throw Error("Assertion error.");
l.push(f)}}var g=new B('<div class="ko-grid">\n    \x3c!--before:grid--\x3e\n    <div class="ko-grid-table-container">\n        \x3c!--before:table--\x3e\n        <div class="ko-grid-table-scroller-padding">\n            <div class="ko-grid-table-scroller">\n                <table class="ko-grid-table" data-bind="_gridWidth: columns.combinedWidth() + \'px\'">\n                    \x3c!--columns--\x3e\n                    \x3c!--head--\x3e\n                    <tfoot class="ko-grid-tfoot" data-bind="_gridWidth: columns.combinedWidth() + \'px\'">\x3c!--tfoot--\x3e</tfoot>\n                    \x3c!--body--\x3e\n                </table>\n            </div>\n        </div>\n        \x3c!--after:table--\x3e\n    </div>\n    \x3c!--after:grid--\x3e\n</div>');
p.forEach(function(b){b.o(g,a)});var h=a.extensions,l=[],q=[];Object.keys(h).forEach(d);var v="ko-grid-template-"+c;f.f(v,g.Sa());m[c]={Va:a,zb:v,bb:l};e()})}function e(a,b){this.Ra=b;this.primaryKey=this.f=b.primaryKey;this.rootElement=a;this.element=this.element=null;this.m=function(){};this.j=function(){};this.Ba=function(a){if(!this.j)throw Error("Illegal state: postApplyBindings-callbacks have been called already.");var b=this.j;this.j=function(){b();a()}}.bind(this)}var d=window.document,b=
l.bindingHandlers.grid=l.bindingHandlers.grid||{},c=["columns","headers","data","layout"],p=c.map(function(a){return A[a]}),f=new l.nativeTemplateEngine;f.f=function(a,b){var c=d.createElement("script");c.id=a;c.type="text/html";c.text=b;d.querySelector("head").appendChild(c)};l.bindingHandlers.grid.init=function(a,d,p,m,q){var t=d(),w=t.config;h(w,function(d,g,h){var p=[],m=new e(a,t);l.utils.domNodeDisposal.addDisposeCallback(a,function(){m.m();p.forEach(function(a){a()})});n.c.Z(A,function(a,b){var c=
new b.k(t,d,m);m[a]=c;m.g=m.columns;m.headers=m.headers;m.data=m.data;m.D=m.layout;"function"===typeof c.m&&p.push(c.m.bind(c))});var r=d.extensions,u=t.extensions||{},y=m.extensions=m.cb={};for(h.forEach(function(a){a=b.N(a);var c=a.sa(r,w),e=a.Ab(u)||{};if((!1!==c.enabled||!0===e.enabled)&&!1!==e.enabled){a.W.forEach(function(a){if(!y[a])throw Error("Dependency '"+a+"' was disabled.");});var f=new a.k(e,c,m,t,d);a.jb.forEach(function(a){y[a]=f});"function"===typeof f.dispose&&p.push(f.dispose.bind(f))}});a.firstChild;)l.removeNode(a.firstChild);
h=q.createChildContext(m,"grid");l.renderTemplate(g,h,{templateEngine:f},a);var x=a.querySelector(".ko-grid");m.element=x;m.element=x;n.c.Z(r,function(a){x.className+=" with-"+n.J.oa(a)});c.forEach(function(a){m[a].B&&m[a].B()});m.j();m.j=null});return{controlsDescendantBindings:!0}};l.bindingHandlers.grid.update=function(){};var m={};l.bindingHandlers._gridWidth={init:function(){},update:function(a,b){var c=b();a.style.width=c;a.style.maxWidth=c}};return b}(w,q,t))});